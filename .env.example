# OpenThreat Environment Configuration
# Copy this file to .env and update with your values

# =============================================================================
# DATABASE CONFIGURATION
# =============================================================================
# For Docker/Production: Use service name 'postgres'
# DATABASE_URL=postgresql://openthreat:YOUR_PASSWORD@postgres:5432/openthreat
#
# For Local Development: Use localhost
# DATABASE_URL=postgresql://openthreat:openthreat@localhost:5432/openthreat
#
# Note: If not set, the system will auto-detect Docker vs local setup
DATABASE_URL=postgresql://openthreat:openthreat@postgres:5432/openthreat

# =============================================================================
# REDIS CONFIGURATION  
# =============================================================================
# For Docker/Production: Use service name 'redis'
REDIS_URL=redis://redis:6379/0
#
# For Local Development: Use localhost
# REDIS_URL=redis://localhost:6379/0

# API Keys (optional but recommended)
NVD_API_KEY=your-nvd-api-key-here

# API Configuration
API_HOST=0.0.0.0
API_PORT=8001
API_WORKERS=4

# Database Pool Configuration
# Pool size is calculated as: (WORKERS_PER_INSTANCE * BACKEND_INSTANCES) + CELERY_WORKERS + buffer
WORKERS_PER_INSTANCE=4  # Uvicorn workers per backend instance
BACKEND_INSTANCES=2     # Number of backend replicas
CELERY_WORKERS=2        # Number of Celery worker instances
DEBUG_POOL=false        # Enable pool debugging (verbose logging)

# Security
SECRET_KEY=your-secret-key-here-change-in-production
CSRF_SECRET_KEY=your-csrf-secret-key-here-change-in-production
ALLOWED_ORIGINS=http://localhost:3000,http://localhost:8001
ENVIRONMENT=production  # Set to 'production' for HTTPS-only cookies

# Authentication
ACCESS_TOKEN_EXPIRE_MINUTES=60  # JWT token expiration (default: 60 minutes)

# Email Configuration (SMTP)
SMTP_ENABLED=false                    # Set to 'true' to enable email sending
SMTP_HOST=smtp.gmail.com              # SMTP server (Gmail, SendGrid, etc.)
SMTP_PORT=587                         # SMTP port (587 for TLS, 465 for SSL)
SMTP_USERNAME=your-email@gmail.com    # SMTP username
SMTP_PASSWORD=your-app-password       # SMTP password or app-specific password
SMTP_FROM_EMAIL=noreply@openthreat.com  # Sender email address
SMTP_FROM_NAME=OpenThreat             # Sender name

# Rate Limiting (Redis-based for multi-replica support)
RATE_LIMIT_PER_MINUTE=60     # Max requests per minute per IP
RATE_LIMIT_PER_HOUR=1000     # Max requests per hour per IP
RATE_LIMIT_WHITELIST=         # Comma-separated IPs to bypass rate limiting (e.g., 127.0.0.1,10.0.0.1)

# Celery
CELERY_BROKER_URL=redis://localhost:6379/0
CELERY_RESULT_BACKEND=redis://localhost:6379/0

# Logging
LOG_LEVEL=INFO

# Data Update Schedule (cron format)
# Default: Every 2 hours
UPDATE_SCHEDULE=0 */2 * * *
